<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>xChat -Responsive Multi-purpose HTML5 Template</title>
	<meta name="description" content="Cabe - Responsive Multi-purpose HTML5 Template">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- STYLESHEETS -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700" rel="stylesheet">
	<link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css" media="all">
	<link rel="stylesheet" href="css/owl.theme.default.min.css" type="text/css" media="all">

	<link rel="stylesheet" href="css/themify-icons.css">

	<link rel="stylesheet" href="main.min.css" type="text/css" media="all">



	<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

	<!-- page tour modal -->

	<div class="modal fade show" id="pagetour">
		<div class="modal-dialog modal-lg modal-md modal-dialog-centered modal-dialog-zoom">
			<div class="modal-content text-center" style="background-image: url(images/bg-2.png);">
				<div class="owl-carousel owl-theme slider-1">
					<div class="item">
						<img src="images/bg-1.jpg" alt="modal">
						<h4 class="text-primary">欢迎您来到某不知名聊天室!</h4>
						<button type="button" class="btn btn-link tour-close-btn" data-dismiss="modal"
							aria-label="Close">跳过</button>
						<button type="button" class="btn btn-primary start-tour">继续</button>

					</div>
					<div class="item">
						<img src="images/bg-1.jpg" alt="modal">
						<h4 class="text-primary">在这里，您可以与您的朋友畅聊!</h4>
						<button type="button" class="btn btn-link tour-close-btn" data-dismiss="modal"
							aria-label="Close">跳过</button>
						<button type="button" class="btn btn-primary next-tour">继续</button>
					</div>
					<div class="item">
						<img src="images/bg-1.jpg" alt="modal">
						<h4 class="text-primary">希望您喜欢我们的某不知名聊天室!</h4>
						<button type="button" class="btn btn-primary start-tour tour-close-btn">太棒了!</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- page tour modal -->

	<!-- add friend modal -->
	<div class="modal fade show" id="addfriend">
		<div class="modal-dialog modal-md modal-md modal-dialog-centered modal-dialog-zoom">
			<div class="modal-content pb-0 d-flex justify-content-between text-center">
				<div class="modal-content pb-0">
					<div class="modal-header add-friend">
						<h5 class="modal-title">
							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
								fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
								stroke-linejoin="round" class="feather feather-user-plus mr-2">
								<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
								<circle cx="8.5" cy="7" r="4"></circle>
								<line x1="20" y1="8" x2="20" y2="14"></line>
								<line x1="23" y1="11" x2="17" y2="11"></line>
							</svg> Add Friends
						</h5>
						<button type="button" class="close" data-dismiss="addfriend" aria-label="close"
							id="addfriend-close">
							<i class="ti-close text-white"></i>
						</button>
					</div>
					<div class="modal-body add-friend pl-4 pr-4">
						<div class="alert alert-info text-left">Send invitations to friends.</div>
						<form>
							<div class="form-group text-left">
								<label for="emails" class="col-form-label">Email addresses</label>
								<input type="text" class="form-control" id="emails">
							</div>
							<div class="form-group text-left">
								<label for="message" class="col-form-label">Invitation message</label>
								<textarea class="form-control" id="message"></textarea>
							</div>
						</form>
					</div>
					<div class="modal-footer add-friend">
						<button type="button" class="btn btn-primary">Submit</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- add friend modal -->

	<!-- video call modal -->
	<div class="modal fade show" id="videocall">
		<div class="modal-dialog modal-lg modal-md modal-dialog-centered modal-dialog-zoom">
			<div class="modal-content pb-0 d-flex justify-content-between text-center bgi-center"
				style="background-image: url(images/video.jpg); min-height: 500px;">
				<div class="modal-header">
					<a href="#" class="live">LIVE</a>
					<a href="#" class="icon-full"><i class="ti-fullscreen"></i></a>
				</div>
				<div class="modal-footer justify-content-center">
					<a href="#" class="icon-bttn bg-danger" id="video-close"><i class="ti-close text-white"></i></a>
					<a href="#" class="icon-bttn bg-success"><i class="ti-check text-white"></i></a>
				</div>
			</div>
		</div>
	</div>
	<!-- video call modal -->



	<!-- main wrapper -->
	<div class="main-wrapper">
		<!-- navigation -->
		<nav class="navigation">
			<div class="container pl-0 pr-0">
				<div class="nav-content">
					<ul>
						<li class="logo d-none d-xl-block d-lg-block"><a href="#"><img src="images/logo.png"
									alt="logo"></a></li>
						<li><a href="#" class="active nav-content-bttn" data-tab="chats" id="chat-list"><span
									class="circle-icon bg-warning"></span><i class="ti-comments"></i></a></li>
						<li><a href="#" class="nav-content-bttn" data-tab="friends" id="friend-list"><span
									class="circle-icon bg-danger"></span><i class="ti-user"></i></a></li>
						<li class="d-none d-xl-block d-lg-block night-mode"><a href="#"><i
									class="ti-flickr-alt"></i></a></li>
					</ul>
				</div>
			</div>
		</nav>
		<!-- navigation -->
		<div class="right-content">
			<div class="left-sidebar">

				<div class="chat-header">
					<div class="chat-header-user">
						<figure class="avatar">
							<a href="#" class="profile-detail-bttn"><img src="images/user-7.png" class="rounded-circle"
									alt="image"></a>
						</figure>
						<div>
							<h5 class="mt-0 mb-0" id="left-top-name">User</h5>
							<small class="text-success" id="left-top-email">Email</small>
						</div>
					</div>
					<div class="chat-header-action nav-content">
						<ul class="list-inline mb-1 mt-3">
							<li class="list-inline-item mr-3"><a href="../login/login.html"><i class="ti-lock"></i></a>
							</li>
							<li class="list-inline-item mr-3"><a href="#" class="nav-content-bttn"
									data-tab="settings"><i class="ti-settings"></i></a></li>
						</ul>
					</div>
				</div>

				<div class="sidebar active" id="chats">
					<div class="text-left mb-1 mt-0">
						<h2 class="title-text"><b>最近</b> 聊天列表</h2>
					</div>
					<div class="form-content">
						<form action="#" class="mb-3 mt-3">
							<input type="text" class="form-control" placeholder="搜索最近聊天">
						</form>
					</div>
					<div class="chat-list-content">
						<ul class="chat-list">
							<li class="chat-list-item">
								<figure class="avatar user-online">
									<img src="images/user-2.png" alt="image">
								</figure>
								<div class="list-body">
									<div class="chat-bttn">
										<h3 class="mb-0 mt-2">Hurin Seary</h3>
										<p>What's up, how are you?</p>
									</div>
									<div class="list-action mt-2 text-right">
										<div class="message-count bg-primary">3</div>
										<small class="text-primary">03:41 PM</small>
									</div>
								</div>
							</li>
						</ul>
					</div>
				</div>
				<div class="sidebar" id="friends">
					<div class="text-left mb-2 mt-3">
						<h2 class="title-text"><b>好友</b> 好友列表 </h2>
					</div>
					<div class="form-content">
						<form action="#" class="mb-3 mt-1">
							<input type="text" class="form-control" placeholder="搜索好友列表">
						</form>
					</div>
					<div class="chat-list-content">
						<ul class="chat-list" id="friend-list-area">
							<li class="chat-list-item">
								<figure class="avatar user-online">
									<img src="images/user-2.png" alt="image">
								</figure>
								<div class="list-body">
									<div class="chat-bttn">
										<h3 class="mb-1 mt-1" id="friend-name">Hurin Seary</h3>
										<p id="friend-motto">test user motto.</p>
									</div>
									<!-- <div class="list-action mt-2 text-right">
										<a href="#" class="btn-plus dropdown-toggle" data-toggle="dropdown"><i
												class="ti-plus"></i></a>
										<div class="dropdown-menu dropdown-menu-right">
											<a href="#" class="dropdown-item" id="addfriend-bttn">Add friend</a>
											<a href="#" class="dropdown-item">Restore</a>
											<div class="dropdown-divider"></div>
											<a href="#" class="dropdown-item text-danger">Delete</a>
										</div>
									</div> -->
								</div>
							</li>
						</ul>
					</div>
				</div>
				<div class="sidebar" id="settings">
					<div class="text-left mb-2 mt-3">
						<h2 class="title-text"><b>账户</b> 设置您的账户 </h2>
					</div>
					<div class="chat-list-content mb-3 mt-3">
						<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
							<div class="panel panel-default">
								<div class="panel-heading" role="tab" id="headingOne">
									<h4 class="panel-title"><a role="button" data-toggle="collapse"
											data-parent="#accordion" href="#collapseOne" aria-expanded="true"
											aria-controls="collapseOne" class="collapsed">我的资料 <span>修改资料</span></a>
									</h4>
								</div>
								<div id="collapseOne" class="panel-collapse collapse" role="tabpanel"
									aria-labelledby="headingOne">
									<div class="panel-body">
										<form action="#" class="mb-3 mt-3">
											<input type="text" class="form-control mb-3" placeholder="用户名">
											<input type="text" class="form-control mb-3" placeholder="邮箱">
											<input type="text" class="form-control mb-3" placeholder="个性签名">
											<button>保存</button>
										</form>
									</div>
								</div>
							</div>

							<div class="panel panel-default">
								<div class="panel-heading" role="tab" id="headingTwo">
									<h4 class="panel-title"><a role="button" data-toggle="collapse"
											data-parent="#accordion" href="#collapseTwo" aria-expanded="true"
											aria-controls="collapseTwo" class="collapsed">隐私与安全设置
											<span>设置隐私与安全</span></a></h4>
								</div>
								<div id="collapseTwo" class="panel-collapse collapse" role="tabpanel"
									aria-labelledby="headingTwo">
									<div class="panel-body">
										<form action="#" class="mb-3 mt-3">
											<input type="text" class="form-control mb-3" placeholder="原密码">
											<input type="text" class="form-control mb-3" placeholder="新密码">
											<input type="text" class="form-control mb-3" placeholder="重置密码">
											<button>提交</button>
										</form>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>

			<div class="chat-content">
				<!-- chat header -->
				<div class="chat-header">
					<div class="chat-header-user">
						<figure class="avatar">
							<img src="images/user-9.png" class="rounded-circle" alt="image">
						</figure>
						<div>
							<h5 class="mt-2 mb-0">样例用户1</h5>
							<small class="text-success">对方正在输入...</small>
						</div>
					</div>
					<div class="chat-header-action">
						<ul class="list-inline mb-0 mt-2">
							<li class="list-inline-item not-mobile"><a href="#" class="bttn-box-round"><i
										class="ti-microphone"></i></a></li>
							<li class="list-inline-item not-mobile"><a href="#" class="bttn-box-round"
									id="videocall-bttn"><i class="ti-video-camera"></i></a></li>
							<li class="list-inline-item d-xl-none d-lg-none"><a href="#"
									class="bttn-box-round back-chat-div"><i class="ti-arrow-left"></i></a></li>
							<li class="list-inline-item">
								<a href="#" class="bttn-box-round" data-toggle="dropdown"><i
										class="ti-more-alt"></i></a>
								<div class="dropdown-menu dropdown-menu-right">
									<a href="#" class="dropdown-item profile-detail-bttn">Profile</a>
									<a href="#" class="dropdown-item">Add to archived</a>
									<div class="dropdown-divider"></div>
									<a href="#" class="dropdown-item text-danger">Block</a>
								</div>
							</li>
						</ul>
					</div>
				</div>
				<!-- chat header -->
				<!-- chat body -->
				<div class="chat-body" style="overflow: hidden;outline: none;">
					<div class="messages-content">
						<div class="message-item">
							<div class="message-user">
								<figure class="avatar">
									<img src="images/user-9.png" alt="image">
								</figure>
								<div>
									<h5>Byrom Guittet</h5>
									<div class="time">01:35 PM</div>
								</div>
							</div>
							<div class="message-wrap">I'm fine, how are you 😃</div>
						</div>

						<div class="message-item outgoing-message">
							<div class="message-user">
								<figure class="avatar">
									<img src="images/user-1.png" alt="image">
								</figure>
								<div>
									<h5>Byrom Guittet</h5>
									<div class="time">01:35 PM<i class="ti-double-check text-info"></i></div>
								</div>
							</div>
							<div class="message-wrap">I want those files for you. I want you to send 1 PDF and 1 image
								file.</div>
						</div>

						<div class="message-item">
							<div class="message-user">
								<figure class="avatar">
									<img src="images/user-9.png" alt="image">
								</figure>
								<div>
									<h5>Byrom Guittet</h5>
									<div class="time">01:35 PM</div>
								</div>
							</div>
							<div class="message-wrap">I've found some cool photos for our travel app.</div>
						</div>

						<div class="message-item outgoing-message">
							<div class="message-user">
								<figure class="avatar">
									<img src="images/user-1.png" alt="image">
								</figure>
								<div>
									<h5>Byrom Guittet</h5>
									<div class="time">01:35 PM<i class="ti-double-check text-info"></i></div>
								</div>
							</div>
							<div class="message-wrap">Hey mate! How are things going ?</div>
						</div>

						<div class="message-item">
							<div class="message-user">
								<figure class="avatar">
									<img src="images/user-9.png" alt="image">
								</figure>
								<div>
									<h5>Byrom Guittet</h5>
									<div class="time">01:35 PM</div>
								</div>
							</div>
							<figure>
								<img src="images/chat-image1.jpg" class="w-75 img-fluid rounded" alt="image">
							</figure>


						</div>

						<div class="message-item outgoing-message">
							<div class="message-user">
								<figure class="avatar">
									<img src="images/user-1.png" alt="image">
								</figure>
								<div>
									<h5>Byrom Guittet</h5>
									<div class="time">01:35 PM<i class="ti-double-check text-info"></i></div>
								</div>
							</div>
							<div class="message-wrap">Hey mate! How are things going ?</div>
						</div>


					</div>
				</div>
				<!-- chat body -->
				<!-- chat footer -->
				<div class="chat-footer">
					<form action="#">
						<input type="text" placeholder="Message Alice Maghyn..">
						<button><img src="images/send.png" alt="send"></button>
					</form>
				</div>
				<!-- chat footer -->
			</div>

			<div class="right-sidebar" style="overflow: hidden;outline: none;">
				<div class="profile-content scroll-profile">
					<header>
						<h2 class="title-text">个人资料</h2>
						<a href="#" class="close-icon float-right"><i class="ti-close  text-danger"></i></a>
					</header>
					<div class="text-center mt-4">
						<figure class="avatar avatar-xl mb-4">
							<img src="images/user-10.png" class="rounded-circle" alt="image">
						</figure>
						<h5 class="mb-0" id="profile-name">James Henry</h5>
						<small class="text-success" id="profile-email">james43@gmail.com</small>

						<ul class="social-link list-inline mt-3">
							<li class="list-inline-item"><a href="#"><i class="ti-facebook bg-facebook"></i></a></li>
							<li class="list-inline-item"><a href="#"><i class="ti-twitter-alt bg-twitter"></i></a></li>
							<li class="list-inline-item"><a href="#"><i class="ti-google bg-google"></i></a></li>
							<li class="list-inline-item"><a href="#"><i class="ti-pinterest bg-pinterest"></i></a></li>
							<li class="list-inline-item"><a href="#"><i class="ti-linkedin bg-linkedIn"></i></a></li>
							<li class="list-inline-item"><a href="#"><i class="ti-github bg-github"></i></a></li>
						</ul>

						<ul class="profile-detail list-inline pt-5">
							<li class="list-block-item text-left">
								<h6 class="mb-0">账号</h6>
								<small id="profile-id">id</small>
							</li>
							<li class="list-block-item text-left">
								<h6 class="mb-0">个性签名</h6>
								<small id="profile-motto">motto</small>
							</li>
							<li class="list-block-item text-left">
								<h6 class="mb-0">等级</h6>
								<small id="profile-level">level</small>
							</li>
							<li class="list-block-item text-left">
								<h6 class="mb-0">创建时间</h6>
								<small id="profile-create-time">Allow connected contacts</small>
							</li>
						</ul>
					</div>
				</div>

			</div>
		</div>

	</div>
	<!-- main wrapper -->

	<div class="model-bg"></div>



	<!-- SCRIPTS -->
	<script src="https://code.jquery.com/jquery-3.6.0.js"
		integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://cdn.goeasy.io/goeasy-2.2.2.min.js"></script>
	<script src="js/plugin.js"></script>
	<script src="js/main.min.js"></script>
	<script type="text/javascript">
		var requestUrl = "http://localhost:8080/api/v1/user"
		// 某api的地址
		var goeasy = GoEasy.getInstance({
			host: "hangzhou.goeasy.io", //若是新加坡区域：singapore.goeasy.io
			appkey: "BC-f0ed0595dbd74b398fdfcac61b1f18d6",
			modules: ['im'] //根据需要，传入‘pubsub’或'im’，或数组方式同时传入
		});
		var im = goeasy.im;
		$(document).ready(function () {
			$.ajax({
				headers: {
					chattoken: localStorage.getItem("chattoken"),
				},
				url: requestUrl + "/" + localStorage.getItem("userId"),
				type: "GET",
				contentType: "application/json;charset=UTF-8",
				success: function (data) {
					console.log(data)
					$("#left-top-name").text(data.userName)
					$("#left-top-email").text(data.userEmail)
					$("#profile-id").text(localStorage.getItem("userId"))
					$("#profile-name").text(data.userName)
					$("#profile-email").text(data.userEmail)
					$("#profile-motto").text(data.userMotto)
					$("#profile-level").text(data.userLevel)
					$("#profile-create-time").text(data.userCreateTime)
				},
				error: function () {

				}
			})
			// 连接到聊天服务器
			console.log("connect")
			goeasy.connect({
				id: "001", //pubsub选填，im必填
				data: {
					"avatar": "/www/xxx.png",
					"nickname": "Test01"
				}, //必须是一个对象，pubsub选填，im必填，用于上下线提醒和查询在线用户列表时，扩展更多的属性
				onSuccess: function () { //连接成功
					console.log("GoEasy connect successfully.") //连接成功
				},
				onFailed: function (error) { //连接失败
					console.log("Failed to connect GoEasy, code:" + error.code + ",error:" + error
						.content);
				},
				onProgress: function (attempts) { //连接或自动重连中
					console.log("GoEasy is connecting", attempts);
				}
			});
		})

		// 获取聊天列表
		$("#chat-list").click(function () {
			im.history({
				userId: localStorage.getItem("userId"), //对方userId
				lastTimestamp: Date.now(), //查询发送时间小于（不包含）该时间的历史消息，可用于分页和分批拉取聊天记录，默认为当前时间
				limit: 10, //可选项，返回的消息条数，默认为10条，最多30条
				onSuccess: function (result) {
					console.log("Query history successfully, result:\n " + JSON.stringify(result));
				},
				onFailed: function (error) { //获取失败
					console.log("Failed to query private message, code:" + error.code +
						" content:" + error
							.content);
				},
			});
		})

		// 获取好友列表
		$("#friend-list").click(function () {
			$.ajax({
				headers: {
					chattoken: localStorage.getItem("chattoken"),
				},
				url: requestUrl + "/friend_list/" + localStorage.getItem("userId"),
				type: "GET",
				contentType: "application/json;charset=UTF-8",
				success: function (data) {

					$.each(data, function (index, item) {
						var string = "<li class='chat-list-item'>" +
							"<figure class='avatar user-online'>" +
							"<img src='images/user-2.png' alt='image'>" + "</figure>" + "<div class='list-body'>" + "<div class='chat-bttn'>"
							+ "<h3 class='mb-1 mt-1' id='friend-name' >" + item.friendName + "</h3 >" + "<p id='friend-motto'>" + item.friendMotto + "</p>" + "</div >" + "</div >" + "</li > "
						$("#friend-list-area").append(string)
					})
				},
				error: function (status) {
					console.log(status)
				}
			})
		})
	</script>

</body>

</html>